<!DOCTYPE html><html class=no-js><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Webhooks | Validating Webhooks | Dwolla API</title><meta name=description content="Validating webhooks for payments within your application by utilizing our open API with no per transaction fees."><meta name=viewport content="width=device-width,initial-scale=1"><link rel=apple-touch-icon sizes=180x180 href=/images/favicons/apple-touch-icon.f62f.png><link rel=icon type=image/png sizes=32x32 href=/images/favicons/favicon-32x32.c226.png><link rel=icon type=image/png sizes=16x16 href=/images/favicons/favicon-16x16.db87.png><link rel=manifest href=/images/favicons/manifest.json><link rel=mask-icon href=/images/favicons/safari-pinned-tab.5f15.svg color=#ff7404><meta name=theme-color content=#ffffff><link rel=stylesheet href=/css/main.b7e3.css><link rel=stylesheet href="//fonts.googleapis.com/css?family=Roboto+Slab:300|Open+Sans:300,400,600,700"><script src=/js/head-scripts.e5a6.js></script><script src=https://cdn.statuspage.io/se-v2.js></script><script>(function(w, d, s, l, i) {
    w[l] = w[l] || [];
    w[l].push({
      'gtm.start': new Date().getTime(),
      event: 'gtm.js'
    });
    var f = d.getElementsByTagName(s)[0],
      j = d.createElement(s),
      dl = l != 'dataLayer' ? '&l=' + l : '';
    j.async = true;
    j.src =
      'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
    f.parentNode.insertBefore(j, f);
  })(window, document, 'script', 'dataLayer', 'GTM-WRT5LD6');</script></head><body><!--[if lt IE 8]>
        <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]--><header><div class="header__primary js-two-col-header-primary"><div class=page-wrap><div><a href=https://www.dwolla.com class="logo icon-logo-dwolla-white">Dwolla</a><div class=hamburger><a href="https://www.dwolla.com/contact?b=nav">Contact Sales</a> <a class="btn primary js-hamburger">Menu</a></div></div><nav class=js-hamburger-nav><a href=https://www.dwolla.com/platform>Platform</a> <a href="/">Developers</a> <a href="https://www.dwolla.com/updates/">Blog</a> <a href=https://www.dwolla.com/login>Login</a> <a class="btn primary" href="https://www.dwolla.com/contact?b=nav">Contact Sales</a></nav></div></div><nav class="header__secondary js-two-col-nav-toggle"><div class=js-two-col-header-secondary><div class=page-wrap><a href="/guides/" class=active>Guides</a> <a href="/resources/">Resources</a> <a href="https://docsv2.dwolla.com/">API docs</a> <a href=/pages/sdks.html class="no-nav js-two-col-no-toggle">SDKs</a><div class="custom-select custom-select--blue js-global-language-select"><select name=select class=js-language-select><option value=raw>raw</option><option value=php>php</option><option value=ruby>ruby</option><option value=python>python</option><option value=javascript>javascript</option></select><div class=arrow></div></div></div></div></nav></header><div class=content><div class=cnt-two-col><div class=page-wrap><section class="cnt-two-col__nav js-two-col-nav"><div class=close><button class="js-two-col-nav-close icon-cnt-two-col-close"></button></div><div class=language-picker><h6>Language</h6><div class="custom-select custom-select--blue"><select class=js-language-select name=select><option value=raw>raw</option><option value=php selected>php</option><option value=ruby>ruby</option><option value=python>python</option><option value=javascript>javascript</option></select><div class=arrow></div></div></div><!-- nav elements below should be in the same order of the secondary navigation --><nav class="side-nav js-side-nav active"><section id=js-sidenav-dropdown class=side-nav__dropdown><h6>Choose a guide</h6><div class=picker id=js-sidenav-dropdown-button><button>Webhooks</button><div class="icon icon-side-nav-collapse-plus"></div><div class="icon icon-side-nav-collapse-minus"></div></div><nav id=js-sidenav-dropdown-nav><a href="/guides/sandbox-setup/">Getting started in Sandbox</a> <a href="/guides/send-money/">Send money to your users</a> <a href="/guides/receive-money/">Receive money from your users</a> <a href="/guides/transfer-money-between-users/">Transfer money between users</a> <a href="/guides/auth/">Authorization</a></nav></section><section class=steps-nav style=display:none><h6>Follow the steps</h6><ol><li><a href=/guides/send-money>Overview: Send money to your users</a><div class=dot></div></li><li><a href=/guides/send-money/onboarding.html>Customer onboarding</a><div class=dot></div></li><li><a href=/guides/send-money/fetch-funding-sources.html>Fetch funding sources</a><div class=dot></div></li><li><a href=/guides/send-money/create-transfer.html class=active>Create a transfer</a><div class=dot></div></li><li><a href=/guides/send-money/check-transfer.html>Check transfer status</a><div class=dot></div></li></ol></section><section class=steps-nav style=display:none><h6>Follow the steps</h6><ol><li><a href=/guides/receive-money>Overview: Receive money from your users</a><div class=dot></div></li><li><a href=/guides/receive-money/onboarding.html>Customer onboarding</a><div class=dot></div></li><li><a href=/guides/receive-money/check-transfer.html>Check transfer status</a><div class=dot></div></li></ol></section><section class=steps-nav style=display:none><h6>Follow the steps</h6><ol><li><a href=/guides/transfer-money-between-users>Overview: transfer money between your users</a><div class=dot></div></li><li><a href=/guides/transfer-money-between-users/obtain-access-token.html>Obtain an application access token</a><div class=dot></div></li><li><a href=/guides/transfer-money-between-users/create-verified-customer.html>Create a Verified Customer</a><div class=dot></div></li><li><a href=/guides/transfer-money-between-users/attach-unverified-bank.html class=active>Attach an unverified funding source</a><div class=dot></div></li><li><a href=/guides/transfer-money-between-users/create-unverified-customer.html>Create an Unverified Customer</a><div class=dot></div></li><li><a href=/guides/transfer-money-between-users/attach-verified-bank.html>Attach a verified funding source</a><div class=dot></div></li><li><a href=/guides/transfer-money-between-users/create-transfer.html>Create a transfer</a><div class=dot></div></li><li><a href=/guides/transfer-money-between-users/check-transfer.html>Check the status of your transfer</a><div class=dot></div></li></ol></section><section class=steps-nav style=display:none><h6>In this guide</h6><ol><li><a href=/guides/auth>Overview: Authorization</a><div class=dot></div></li><li><a href=/guides/auth/client-credentials-flow.html>Client credentials flow</a><div class=dot></div></li><li><a href=/guides/auth/using-an-access-token.html class=active>Using an access token</a><div class=dot></div></li></ol></section><section class=steps-nav><h6>Follow the steps</h6><ol><li><a href=/guides/webhooks>Overview: Webhooks</a><div class=dot></div></li><li><a href=/guides/webhooks/obtain-authorization.html>Obtain authorization</a><div class=dot></div></li><li><a href=/guides/webhooks/create-subscription.html>Create a webhook subscription</a><div class=dot></div></li><li><a href=/guides/webhooks/validating-webhooks.html class=active>Validating webhooks</a><div class=dot></div></li><li><a href=/guides/webhooks/process-webhooks.html>Processing webhooks</a><div class=dot></div></li></ol></section><section class=steps-nav style=display:none><h6>Follow the steps</h6><ol><li><a href=/guides/migrate-to-v2>Overview: Migrate to the Dwolla v2 API</a><div class=dot></div></li><li><a href=/guides/migrate-to-v2/01-api-v2-principles.html>Dwolla v2 API principles</a><div class=dot></div></li><li><a href=/guides/migrate-to-v2/02-making-requests.html>Making requests</a><div class=dot></div></li><li><a href=/guides/migrate-to-v2/03-authentication.html class=active>Authentication</a><div class=dot></div></li><li><a href=/guides/migrate-to-v2/04-sdk-support.html>SDK support</a><div class=dot></div></li><li><a href=/guides/migrate-to-v2/05-v1-to-v2-endpoint-changes.html>v1 to Dwolla v2 API endpoint changes</a><div class=dot></div></li><li><a href=/guides/migrate-to-v2/06-other-notable-changes.html>Other notable changes</a><div class=dot></div></li><li><a href=/guides/migrate-to-v2/07-faq.html>FAQ</a><div class=dot></div></li></ol></section><section class=steps-nav style=display:none><h6>In this guide</h6><ol><li><a href=/guides/offsite-gateway>Overview: Off-Site Gateway</a><div class=dot></div></li><li><a href=/guides/offsite-gateway/direct-submit.html>Direct submit option</a><div class=dot></div></li><li><a href=/guides/offsite-gateway/server-to-server.html>Server-to-server option</a><div class=dot></div></li></ol></section><section class=side-nav__options><h6>Other Resources</h6><ul><li><a href="/guides/migrate-to-v2/"><span>Migrate to the Dwolla v2 API</span></a></li><li><a href="/guides/offsite-gateway/"><span>Off-Site Gateway</span></a></li><li class=external-link><a href="https://docs.dwolla.com/" target=_blank><span class=icon-sidenav-option>API v1 reference docs</span></a></li><li class=external-link><a href="https://docsv2.dwolla.com/transfer/" target=_blank><span class=icon-sidenav-option>Transfer API Docs</span></a></li></ul></section></nav><nav class="side-nav js-side-nav"><section><h6>Tools</h6><ul><li class=external-link><a href="http://dashboard-sandbox.dwolla.com/" target=_blank><span class=icon-sidenav-option>Sandbox Dashboard</span></a></li><li><a href=/resources/token-generator.html>Token generator</a></li><li><a href=/resources/changelog.html>Change log</a></li><li class=external-link><a href="http://status.dwolla.com/" target=_blank><span class=icon-sidenav-option>Status</span></a></li></ul><h6>The API Basics</h6><ul><li><a href=/resources/account-types.html>Account types</a><ul></ul></li><li><a href=/resources/bank-transfer-workflow.html>Bank transfer workflow</a><ul><li><a href=/resources/bank-transfer-workflow/processing-times.html>Processing times</a></li><li><a href=/resources/bank-transfer-workflow/transfer-failures.html>Transfer failures</a></li></ul></li><li><a href=/resources/customer-verification.html>Customer verification</a><ul><li><a href=/resources/customer-verification/personal-verified-customers.html>Personal verified Customers</a></li><li><a href=/resources/customer-verification/business-verified-customers.html>Business verified Customers</a></li><li><a href=/resources/customer-verification/handling-verification-statuses.html>Handling verification statuses</a></li></ul></li><li><a href=/resources/funding-source-verification.html>Funding source verification</a><ul><li><a href=/resources/funding-source-verification/micro-deposit-verification.html>Micro-deposit verification</a></li><li><a href=/resources/funding-source-verification/instant-account-verification.html>Instant account verification</a></li></ul></li><li><a href=/resources/testing.html>Testing in the Sandbox</a><ul></ul></li></ul><h6>Features</h6><ul><li><a href=/resources/dwolla-js.html>Dwolla.js</a><ul><li><a href=/resources/dwolla-js/add-a-bank-account.html>Add a bank account</a></li><li><a href=/resources/dwolla-js/instant-account-verification.html>Instant account verification</a></li><li><a href=/resources/dwolla-js/on-demand-bank-transfers.html>On-demand bank transfers</a></li></ul></li><li><a href=/resources/facilitator-fee.html>Facilitator fee</a><ul></ul></li><li><a href=/resources/same-day-ach.html>Same Day ACH</a><ul></ul></li><li><a href=/resources/wire-transfer-api.html>Wire transfer API</a><ul></ul></li></ul><h6>Integrations</h6><ul><li><a href=/resources/dwolla-plaid-integration.html>Dwolla + Plaid Integration</a><ul></ul></li><li><a href=/resources/dwolla-sift-science-integration.html>Sift Science Integration</a><ul></ul></li></ul></section></nav><nav class="side-nav js-side-nav"><section id=js-sidenav-dropdown class=side-nav__dropdown><ul><li><a href=https://docsv2.dwolla.com/#introduction>Introduction</a></li><li><a href=https://docsv2.dwolla.com/#oauth>OAuth</a></li><li><a href=https://docsv2.dwolla.com/#customers>Customers</a></li><li><a href=https://docsv2.dwolla.com/#documents>Documents</a></li><li><a href=https://docsv2.dwolla.com/#funding-sources>Funding Sources</a></li><li><a href=https://docsv2.dwolla.com/#transfers>Transfers</a></li><li><a href=https://docsv2.dwolla.com/#events>Events</a></li><li><a href=https://docsv2.dwolla.com/#webhook-subscriptions>Webhook Subscriptions</a></li><li><a href=https://docsv2.dwolla.com/#webhooks>Webhooks</a></li></ul></section></nav></section><section class=cnt-two-col__content><h1 id=step-3-validating-webhooks>Step 3: Validating webhooks</h1><p>Assume that your integration is an online marketplace, and that a customer just placed an order on your site. A few days after the customer initiated their payment, your application receives this webhook.</p><p>The <code>topic</code> field of an event holds <a href=http://docsv2.dwolla.com/#events>a description</a> of the event, which is similar the subject of an e-mail message. The <code>webhook</code> itself contains <code>_links</code> to the resource impacted by the event that can be used to retrieve more information about the webhook you have received.</p><p><strong>NOTE</strong>: The <code>event</code> must be retrieved with a <code>client_credentials</code> granted access_token.</p><h5 id=json>JSON</h5><div class="code-snippet js-code-snippet language-jsonnohide"><button class="btn alternative">copy</button><div class="code-snippet__cnt highlight"><pre><code class=language-jsonnohide data-lang=jsonnohide><span class=p>{</span><span class=w>
  </span><span class=nt>"id"</span><span class=p>:</span><span class=w> </span><span class=s2>"cac95329-9fa5-42f1-a4fc-c08af7b868fb"</span><span class=p>,</span><span class=w>
  </span><span class=nt>"resourceId"</span><span class=p>:</span><span class=w> </span><span class=s2>"cdb5f11f-62df-e611-80ee-0aa34a9b2388"</span><span class=p>,</span><span class=w>
  </span><span class=nt>"topic"</span><span class=p>:</span><span class=w> </span><span class=s2>"customer_transfer_created"</span><span class=p>,</span><span class=w>
  </span><span class=nt>"timestamp"</span><span class=p>:</span><span class=w> </span><span class=s2>"2017-01-20T22:45:12.790Z"</span><span class=p>,</span><span class=w>
  </span><span class=nt>"_links"</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=w>
    </span><span class=nt>"self"</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=w>
      </span><span class=nt>"href"</span><span class=p>:</span><span class=w> </span><span class=s2>"https://api-sandbox.dwolla.com/events/cac95329-9fa5-42f1-a4fc-c08af7b868fb"</span><span class=w>
    </span><span class=p>},</span><span class=w>
    </span><span class=nt>"account"</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=w>
      </span><span class=nt>"href"</span><span class=p>:</span><span class=w> </span><span class=s2>"https://api-sandbox.dwolla.com/accounts/ad5f2162-404a-4c4c-994e-6ab6c3a13254"</span><span class=w>
    </span><span class=p>},</span><span class=w>
    </span><span class=nt>"resource"</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=w>
      </span><span class=nt>"href"</span><span class=p>:</span><span class=w> </span><span class=s2>"https://api-sandbox.dwolla.com/transfers/cdb5f11f-62df-e611-80ee-0aa34a9b2388"</span><span class=w>
    </span><span class=p>},</span><span class=w>
    </span><span class=nt>"customer"</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=w>
      </span><span class=nt>"href"</span><span class=p>:</span><span class=w> </span><span class=s2>"https://api-sandbox.dwolla.com/customers/e358a488-6699-4d79-bbfb-c5bf58100ea4"</span><span class=w>
    </span><span class=p>}</span><span class=w>
  </span><span class=p>},</span><span class=w>
  </span><span class=nt>"created"</span><span class=p>:</span><span class=w> </span><span class=s2>"2017-01-20T22:45:12.790Z"</span><span class=w>
</span><span class=p>}</span><span class=w>
</span></code></pre></div></div><h2 id=step-3a-authenticating-the-webhook-request>Step 3A. Authenticating the webhook request</h2><p>Before we process any data from the webhook we’ll want to validate that the request really came from Dwolla and not someone pretending to be Dwolla. Dwolla signs each webhook request with the <code>secret</code> you passed in when you created the webhook subscription. The signature is contained in the <code>X-Request-Signature-Sha-256</code> header and is a SHA256 HMAC hash of the request body with the key being your webhook secret.</p><p>You can validate the webhook by generating the same SHA256 HMAC hash and comparing it to the signature sent with the payload.</p><div class="code-snippet js-code-snippet language-ruby"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-ruby data-lang=ruby><span class=k>def</span> <span class=nf>verify_signature</span><span class=p>(</span><span class=n>payload_body</span><span class=p>,</span> <span class=n>request_signature</span><span class=p>)</span>
  <span class=n>signature</span> <span class=o>=</span> <span class=no>OpenSSL</span><span class=o>::</span><span class=no>HMAC</span><span class=p>.</span><span class=nf>hexdigest</span><span class=p>(</span><span class=no>OpenSSL</span><span class=o>::</span><span class=no>Digest</span><span class=p>.</span><span class=nf>new</span><span class=p>(</span><span class=s2>"sha256"</span><span class=p>),</span>
<span class=no>ENV</span><span class=p>[</span><span class=s2>"DWOLLA_WEBHOOK_SECRET"</span><span class=p>],</span>
<span class=n>payload_body</span><span class=p>)</span>
  <span class=k>unless</span> <span class=no>Rack</span><span class=o>::</span><span class=no>Utils</span><span class=p>.</span><span class=nf>secure_compare</span><span class=p>(</span><span class=n>signature</span><span class=p>,</span> <span class=n>request_signature</span><span class=p>)</span>
    <span class=n>halt</span> <span class=mi>500</span><span class=p>,</span> <span class=s2>"Signatures didn't match!"</span>
  <span class=k>end</span>
<span class=k>end</span>
</code></pre></div></div><div class="code-snippet js-code-snippet language-raw"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-raw data-lang=raw>not available
</code></pre></div></div><div class="code-snippet js-code-snippet language-javascript"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-javascript data-lang=javascript><span class=kd>var</span> <span class=nx>verifyGatewaySignature</span> <span class=o>=</span> <span class=kd>function</span><span class=p>(</span><span class=nx>proposed_signature</span><span class=p>,</span> <span class=nx>webhook_secret</span><span class=p>,</span> <span class=nx>payload_body</span><span class=p>)</span> <span class=p>{</span>
  <span class=kd>var</span> <span class=nx>crypto</span>    <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>'crypto'</span><span class=p>);</span>

  <span class=kd>var</span> <span class=nx>hash</span> <span class=o>=</span> <span class=nx>crypto</span><span class=p>.</span><span class=nx>createHmac</span><span class=p>(</span><span class=s1>'sha256'</span><span class=p>,</span> <span class=nx>webhook_secret</span><span class=p>).</span><span class=nx>update</span><span class=p>(</span><span class=nx>payload_body</span><span class=p>).</span><span class=nx>digest</span><span class=p>(</span><span class=s1>'hex'</span><span class=p>);</span>

<span class=k>return</span> <span class=nx>proposed_signature</span> <span class=o>===</span> <span class=nx>hash</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div></div><div class="code-snippet js-code-snippet language-python"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-python data-lang=python><span class=k>def</span> <span class=nf>verify_gateway_signature</span><span class=p>(</span><span class=n>proposed_signature</span><span class=p>,</span> <span class=n>webhook_secret</span><span class=p>,</span> <span class=n>payload_body</span><span class=p>):</span>
  <span class=kn>import</span> <span class=nn>hmac</span>
  <span class=kn>from</span> <span class=nn>hashlib</span> <span class=kn>import</span> <span class=n>sha256</span>

  <span class=n>signature</span> <span class=o>=</span> <span class=n>hmac</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>webhook_secret</span><span class=p>,</span> <span class=n>payload_body</span><span class=p>,</span> <span class=n>sha256</span><span class=p>)</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>

  <span class=k>return</span> <span class=bp>True</span> <span class=k>if</span> <span class=p>(</span><span class=n>signature</span> <span class=o>==</span> <span class=n>proposed_signature</span><span class=p>)</span> <span class=k>else</span> <span class=bp>False</span>
</code></pre></div></div><div class="code-snippet js-code-snippet language-php"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-php data-lang=php><span class=cp>&lt;?php</span>
<span class=k>function</span> <span class=nf>verifyGatewaySignature</span><span class=p>(</span><span class=nv>$proposedSignature</span><span class=p>,</span> <span class=nv>$webhookSecret</span><span class=p>,</span> <span class=nv>$payloadBody</span><span class=p>)</span> <span class=p>{</span>
    <span class=nv>$signature</span> <span class=o>=</span> <span class=nb>hash_hmac</span><span class=p>(</span><span class=s2>"sha256"</span><span class=p>,</span> <span class=nv>$payloadBody</span><span class=p>,</span> <span class=nv>$webhookSecret</span><span class=p>);</span>
    <span class=k>return</span> <span class=nv>$signature</span> <span class=o>==</span> <span class=nv>$proposedSignature</span><span class=p>;</span>
<span class=p>}</span>
<span class=cp>?&gt;</span>
</code></pre></div></div><h2 id=step-3b-check-for-duplicate-events>Step 3B. Check for duplicate events</h2><p>It is important to consider that multiple webhooks are fired for the same action on certain events. For example, multiple webhooks are fired for <code>Transfer</code> events, that is, two <code>transfer_created</code> events with different resource IDs (and, by extension, resource URLs) will be fired, one for each customer. To avoid doing any business logic twice, you would have to check if you have already received a webhook relating to the <code>Transfer</code> resource responsible for the event.</p><p>To do this, keep a queue of events in a database and check to see if an <code>Event</code> has the same <code>self</code> resource location in <code>_links</code> as another event. If not, process the logic for that event. To illustrate, this is how a developer would implement this using Ruby and the ActiveRecord ORM.</p><h5 id=ruby-activerecord>Ruby/ActiveRecord</h5><div class="code-snippet js-code-snippet language-rubynohide"><button class="btn alternative">copy</button><div class="code-snippet__cnt highlight"><pre><code class=language-rubynohide data-lang=rubynohide><span class=n>check_db</span> <span class=o>=</span> <span class=no>ActiveRecord</span><span class=o>::</span><span class=no>Base</span><span class=p>.</span><span class=nf>connection</span><span class=p>.</span><span class=nf>execute</span><span class=p>(</span><span class=s2>"SELECT * FROM EVENTS WHERE SELF = </span><span class=si>#{</span><span class=n>event</span><span class=p>[</span><span class=ss>:_links</span><span class=p>][</span><span class=ss>:self</span><span class=p>].</span><span class=nf>to_s</span><span class=si>}</span><span class=s2>"</span><span class=p>)</span>

<span class=c1># check_db will be an array of rows returned</span>
<span class=k>unless</span> <span class=n>check_db</span><span class=p>.</span><span class=nf>length</span><span class=p>()</span> <span class=o>==</span> <span class=mi>0</span>
    <span class=c1># do something</span>
<span class=k>end</span>
</code></pre></div></div><nav class=pager-nav><a href=create-subscription.html>Back: Create a webhook subscription</a> <a href=process-webhooks.html>Next step: Processing webhooks</a></nav><hr><footer><div class=page-wrap><nav><h6>Product</h6><a href=https://www.dwolla.com/platform>Platform</a> <a href=https://www.dwolla.com/bank-transfers>Bank Transfers</a> <a href=https://www.dwolla.com/same-day-ach>Expedited Payments</a> <a href=https://www.dwolla.com/dwollajs-bank-verification>Instant Bank Account Verification</a> <a href=https://www.dwolla.com/mass-payments-api>Mass Payments</a> <a href="https://www.dwolla.com/integrations?b=footer">Integrations</a> <a href=https://www.dwolla.com/white-label>White Label</a> <a href=https://www.dwolla.com/ach-transfer-dashboard>Dashboard</a></nav><nav><h6>Legal</h6><a href="https://www.dwolla.com/legal/tos/">Terms of Service</a> <a href="https://www.dwolla.com/legal/privacy/">Privacy Policy</a> <a href=https://www.dwolla.com/security>Security</a> <a href="https://www.dwolla.com/legal/about-our-financial-institution-partner/">Financial Institution Partners</a></nav><nav><h6>Learn More</h6><a href="https://www.dwolla.com/case-studies?b=accesscta1">Case Studies</a> <a href="https://www.dwolla.com/updates/">Blog</a> <a href=https://www.dwolla.com/industry-initiatives>Industry Initiatives</a> <a href="https://developers.dwolla.com/?b=footer">Developer Resources</a></nav><nav><h6>Company</h6><a href="https://www.dwolla.com/about?b=footer">About</a> <a href=https://www.dwolla.com/careers>Careers</a> <a href=https://www.dwolla.com/press>Press</a> <a href="https://www.dwolla.com/contact?b=footer">Contact Us</a></nav></div></footer><section class=disclaimer><div class=page-wrap><h5>Financial institutions play an important role in the Dwolla network.</h5><p>Dwolla, Inc. is an agent of Veridian Credit Union and Compass Bank and all funds associated with your account in the Dwolla network are held in pooled accounts at Veridian Credit Union and Compass Bank. These funds are not eligible for individual insurance, including FDIC insurance and may not be eligible for share insurance by the National Credit Union Share Insurance Fund. Dwolla, Inc. is the operator of a software platform that communicates user instructions for funds transfers to Veridian Credit Union and Compass Bank.</p></div></section><section class=copyright><div class=page-wrap><div><span>&copy; 2018 Dwolla, Inc.</span> <a href="https://www.dwolla.com/legal/about-our-financial-institution-partner/">Dwolla, Inc. is an agent of its Financial Institution Partner(s)</a></div></div></section></section></div></div></div><script src=//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js></script><script>window.jQuery || document.write('<script src="/_bower_components/jquery/jquery.min.js"><\/script>')</script><script src=/js/script.c827.js></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
  function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
  e=o.createElement(i);r=o.getElementsByTagName(i)[0];
  e.src='//www.google-analytics.com/analytics.js';
  r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
  ga('create','UA-30404064-1');ga('send','pageview');</script><script type=text/javascript>(function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',intercomSettings);}else{var d=document;var i=function(){i.c(arguments)};i.q=[];i.c=function(args){i.q.push(args)};w.Intercom=i;function l(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/dfdjs7vb';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);}if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})()

  window.Intercom('boot', {
    app_id: 'dfdjs7vb'
  });</script><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WRT5LD6" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript></body></html>