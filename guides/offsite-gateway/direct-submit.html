<!DOCTYPE html><html class=no-js><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Off-Site Gateway | Direct Submit | Dwolla API</title><meta name=description content="Obtain an OAuth access token, used to access data in the Dwolla API on behalf of a user or application. Learn more about how to utilize the direct submit option."><meta name=viewport content="width=device-width,initial-scale=1"><link rel=apple-touch-icon sizes=180x180 href=/images/favicons/apple-touch-icon.f62f.png><link rel=icon type=image/png sizes=32x32 href=/images/favicons/favicon-32x32.c226.png><link rel=icon type=image/png sizes=16x16 href=/images/favicons/favicon-16x16.db87.png><link rel=manifest href=/images/favicons/manifest.json><link rel=mask-icon href=/images/favicons/safari-pinned-tab.5f15.svg color=#ff7404><meta name=theme-color content=#ffffff><link rel=stylesheet href=/css/main.b7e3.css><link rel=stylesheet href="//fonts.googleapis.com/css?family=Roboto+Slab:300|Open+Sans:300,400,600,700"><script src=/js/head-scripts.e5a6.js></script><script src=https://cdn.statuspage.io/se-v2.js></script><script>(function(w, d, s, l, i) {
    w[l] = w[l] || [];
    w[l].push({
      'gtm.start': new Date().getTime(),
      event: 'gtm.js'
    });
    var f = d.getElementsByTagName(s)[0],
      j = d.createElement(s),
      dl = l != 'dataLayer' ? '&l=' + l : '';
    j.async = true;
    j.src =
      'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
    f.parentNode.insertBefore(j, f);
  })(window, document, 'script', 'dataLayer', 'GTM-WRT5LD6');</script></head><body><!--[if lt IE 8]>
        <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]--><header><div class="header__primary js-two-col-header-primary"><div class=page-wrap><div><a href=https://www.dwolla.com class="logo icon-logo-dwolla-white">Dwolla</a><div class=hamburger><a href="https://www.dwolla.com/contact?b=nav">Contact Sales</a> <a class="btn primary js-hamburger">Menu</a></div></div><nav class=js-hamburger-nav><a href=https://www.dwolla.com/platform>Platform</a> <a href="/">Developers</a> <a href="https://www.dwolla.com/updates/">Blog</a> <a href=https://www.dwolla.com/login>Login</a> <a class="btn primary" href="https://www.dwolla.com/contact?b=nav">Contact Sales</a></nav></div></div><nav class="header__secondary js-two-col-nav-toggle"><div class=js-two-col-header-secondary><div class=page-wrap><a href="/guides/" class=active>Guides</a> <a href="/resources/">Resources</a> <a href="https://docsv2.dwolla.com/">API docs</a> <a href=/pages/sdks.html class="no-nav js-two-col-no-toggle">SDKs</a><div class="custom-select custom-select--blue js-global-language-select"><select name=select class=js-language-select><option value=raw>raw</option><option value=php>php</option><option value=ruby>ruby</option><option value=python>python</option><option value=javascript>javascript</option></select><div class=arrow></div></div></div></div></nav></header><div class=content><div class=cnt-two-col><div class=page-wrap><section class="cnt-two-col__nav js-two-col-nav"><div class=close><button class="js-two-col-nav-close icon-cnt-two-col-close"></button></div><div class=language-picker><h6>Language</h6><div class="custom-select custom-select--blue"><select class=js-language-select name=select><option value=raw>raw</option><option value=php selected>php</option><option value=ruby>ruby</option><option value=python>python</option><option value=javascript>javascript</option></select><div class=arrow></div></div></div><!-- nav elements below should be in the same order of the secondary navigation --><nav class="side-nav js-side-nav active"><section id=js-sidenav-dropdown class=side-nav__dropdown><h6>Choose a guide</h6><div class=picker id=js-sidenav-dropdown-button><button>Please select a guide</button><div class="icon icon-side-nav-collapse-plus"></div><div class="icon icon-side-nav-collapse-minus"></div></div><nav id=js-sidenav-dropdown-nav><a href="/guides/sandbox-setup/">Getting started in Sandbox</a> <a href="/guides/send-money/">Send money to your users</a> <a href="/guides/receive-money/">Receive money from your users</a> <a href="/guides/transfer-money-between-users/">Transfer money between users</a> <a href="/guides/auth/">Authorization</a> <a href="/guides/webhooks/">Webhooks</a></nav></section><section class=steps-nav style=display:none><h6>Follow the steps</h6><ol><li><a href=/guides/send-money>Overview: Send money to your users</a><div class=dot></div></li><li><a href=/guides/send-money/onboarding.html class=active>Customer onboarding</a><div class=dot></div></li><li><a href=/guides/send-money/fetch-funding-sources.html>Fetch funding sources</a><div class=dot></div></li><li><a href=/guides/send-money/create-transfer.html>Create a transfer</a><div class=dot></div></li><li><a href=/guides/send-money/check-transfer.html>Check transfer status</a><div class=dot></div></li></ol></section><section class=steps-nav style=display:none><h6>Follow the steps</h6><ol><li><a href=/guides/receive-money>Overview: Receive money from your users</a><div class=dot></div></li><li><a href=/guides/receive-money/onboarding.html class=active>Customer onboarding</a><div class=dot></div></li><li><a href=/guides/receive-money/check-transfer.html>Check transfer status</a><div class=dot></div></li></ol></section><section class=steps-nav style=display:none><h6>Follow the steps</h6><ol><li><a href=/guides/transfer-money-between-users>Overview: transfer money between your users</a><div class=dot></div></li><li><a href=/guides/transfer-money-between-users/obtain-access-token.html class=active>Obtain an application access token</a><div class=dot></div></li><li><a href=/guides/transfer-money-between-users/create-verified-customer.html>Create a Verified Customer</a><div class=dot></div></li><li><a href=/guides/transfer-money-between-users/attach-unverified-bank.html>Attach an unverified funding source</a><div class=dot></div></li><li><a href=/guides/transfer-money-between-users/create-unverified-customer.html>Create an Unverified Customer</a><div class=dot></div></li><li><a href=/guides/transfer-money-between-users/attach-verified-bank.html>Attach a verified funding source</a><div class=dot></div></li><li><a href=/guides/transfer-money-between-users/create-transfer.html>Create a transfer</a><div class=dot></div></li><li><a href=/guides/transfer-money-between-users/check-transfer.html>Check the status of your transfer</a><div class=dot></div></li></ol></section><section class=steps-nav style=display:none><h6>In this guide</h6><ol><li><a href=/guides/auth>Overview: Authorization</a><div class=dot></div></li><li><a href=/guides/auth/client-credentials-flow.html>Client credentials flow</a><div class=dot></div></li><li><a href=/guides/auth/using-an-access-token.html>Using an access token</a><div class=dot></div></li></ol></section><section class=steps-nav style=display:none><h6>Follow the steps</h6><ol><li><a href=/guides/webhooks>Overview: Webhooks</a><div class=dot></div></li><li><a href=/guides/webhooks/obtain-authorization.html class=active>Obtain authorization</a><div class=dot></div></li><li><a href=/guides/webhooks/create-subscription.html>Create a webhook subscription</a><div class=dot></div></li><li><a href=/guides/webhooks/validating-webhooks.html>Validating webhooks</a><div class=dot></div></li><li><a href=/guides/webhooks/process-webhooks.html>Processing webhooks</a><div class=dot></div></li></ol></section><section class=steps-nav style=display:none><h6>Follow the steps</h6><ol><li><a href=/guides/migrate-to-v2>Overview: Migrate to the Dwolla v2 API</a><div class=dot></div></li><li><a href=/guides/migrate-to-v2/01-api-v2-principles.html class=active>Dwolla v2 API principles</a><div class=dot></div></li><li><a href=/guides/migrate-to-v2/02-making-requests.html>Making requests</a><div class=dot></div></li><li><a href=/guides/migrate-to-v2/03-authentication.html>Authentication</a><div class=dot></div></li><li><a href=/guides/migrate-to-v2/04-sdk-support.html>SDK support</a><div class=dot></div></li><li><a href=/guides/migrate-to-v2/05-v1-to-v2-endpoint-changes.html>v1 to Dwolla v2 API endpoint changes</a><div class=dot></div></li><li><a href=/guides/migrate-to-v2/06-other-notable-changes.html>Other notable changes</a><div class=dot></div></li><li><a href=/guides/migrate-to-v2/07-faq.html>FAQ</a><div class=dot></div></li></ol></section><section class=steps-nav><h6>In this guide</h6><ol><li><a href=/guides/offsite-gateway>Overview: Off-Site Gateway</a><div class=dot></div></li><li><a href=/guides/offsite-gateway/direct-submit.html class=active>Direct submit option</a><div class=dot></div></li><li><a href=/guides/offsite-gateway/server-to-server.html>Server-to-server option</a><div class=dot></div></li></ol></section><section class=side-nav__options><h6>Other Resources</h6><ul><li><a href="/guides/migrate-to-v2/"><span>Migrate to the Dwolla v2 API</span></a></li><li><a href="/guides/offsite-gateway/"><span>Off-Site Gateway</span></a></li><li class=external-link><a href="https://docs.dwolla.com/" target=_blank><span class=icon-sidenav-option>API v1 reference docs</span></a></li><li class=external-link><a href="https://docsv2.dwolla.com/transfer/" target=_blank><span class=icon-sidenav-option>Transfer API Docs</span></a></li></ul></section></nav><nav class="side-nav js-side-nav"><section><h6>Tools</h6><ul><li class=external-link><a href="http://dashboard-sandbox.dwolla.com/" target=_blank><span class=icon-sidenav-option>Sandbox Dashboard</span></a></li><li><a href=/resources/token-generator.html>Token generator</a></li><li><a href=/resources/changelog.html>Change log</a></li><li class=external-link><a href="http://status.dwolla.com/" target=_blank><span class=icon-sidenav-option>Status</span></a></li></ul><h6>The API Basics</h6><ul><li><a href=/resources/account-types.html>Account types</a><ul></ul></li><li><a href=/resources/bank-transfer-workflow.html>Bank transfer workflow</a><ul><li><a href=/resources/bank-transfer-workflow/processing-times.html>Processing times</a></li><li><a href=/resources/bank-transfer-workflow/transfer-failures.html>Transfer failures</a></li></ul></li><li><a href=/resources/customer-verification.html>Customer verification</a><ul><li><a href=/resources/customer-verification/personal-verified-customers.html>Personal verified Customers</a></li><li><a href=/resources/customer-verification/business-verified-customers.html>Business verified Customers</a></li><li><a href=/resources/customer-verification/handling-verification-statuses.html>Handling verification statuses</a></li></ul></li><li><a href=/resources/funding-source-verification.html>Funding source verification</a><ul><li><a href=/resources/funding-source-verification/micro-deposit-verification.html>Micro-deposit verification</a></li><li><a href=/resources/funding-source-verification/instant-account-verification.html>Instant account verification</a></li></ul></li><li><a href=/resources/testing.html>Testing in the Sandbox</a><ul></ul></li></ul><h6>Features</h6><ul><li><a href=/resources/dwolla-js.html>Dwolla.js</a><ul><li><a href=/resources/dwolla-js/add-a-bank-account.html>Add a bank account</a></li><li><a href=/resources/dwolla-js/instant-account-verification.html>Instant account verification</a></li><li><a href=/resources/dwolla-js/on-demand-bank-transfers.html>On-demand bank transfers</a></li></ul></li><li><a href=/resources/facilitator-fee.html>Facilitator fee</a><ul></ul></li><li><a href=/resources/same-day-ach.html>Same Day ACH</a><ul></ul></li><li><a href=/resources/wire-transfer-api.html>Wire transfer API</a><ul></ul></li></ul><h6>Integrations</h6><ul><li><a href=/resources/dwolla-plaid-integration.html>Dwolla + Plaid Integration</a><ul></ul></li><li><a href=/resources/dwolla-sift-science-integration.html>Sift Science Integration</a><ul></ul></li></ul></section></nav><nav class="side-nav js-side-nav"><section id=js-sidenav-dropdown class=side-nav__dropdown><ul><li><a href=https://docsv2.dwolla.com/#introduction>Introduction</a></li><li><a href=https://docsv2.dwolla.com/#oauth>OAuth</a></li><li><a href=https://docsv2.dwolla.com/#customers>Customers</a></li><li><a href=https://docsv2.dwolla.com/#documents>Documents</a></li><li><a href=https://docsv2.dwolla.com/#funding-sources>Funding Sources</a></li><li><a href=https://docsv2.dwolla.com/#transfers>Transfers</a></li><li><a href=https://docsv2.dwolla.com/#events>Events</a></li><li><a href=https://docsv2.dwolla.com/#webhook-subscriptions>Webhook Subscriptions</a></li><li><a href=https://docsv2.dwolla.com/#webhooks>Webhooks</a></li></ul></section></nav></section><section class=cnt-two-col__content><h1 id=off-site-gateway-checkout>Off-Site Gateway Checkout</h1><h2 id=direct-submit>Direct submit</h2><p>This option is great for cases where there is only one item that needs to be purchased. Common use cases are: donation purposes, paying a one-time subscription fee, or buying a single product. In order to initiate direct submission, a form must be directly submitted to the Off-Site Gateway endpoint <code>payment/pay</code> with all required checkout information. The user will be redirected to Dwolla where the checkout process will be completed.</p><h4 id=http-request>HTTP request</h4><p><code>POST https://www.dwolla.com/payment/pay</code></p><h5 id=request-parameters>Request parameters</h5><table><thead><tr><th>Parameter</th><th>Required</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>key</td><td>yes</td><td>string</td><td>Application key.</td></tr><tr><td>signature</td><td>yes</td><td>string</td><td>HMAC-SHA1 hex hash of the app key, timestamp, and order ID.</td></tr><tr><td>timestamp</td><td>yes</td><td>string</td><td>Timestamp of the generated purchase order. Represented as the UNIX epoch time.</td></tr><tr><td>destinationId</td><td>yes</td><td>string</td><td>Dwolla ID of the account receiving the funds. Format will always match <code>812-xxx-xxxx</code>.</td></tr><tr><td>amount</td><td>yes</td><td>string</td><td>Amount of order. Must be at least $0.01.</td></tr><tr><td>name</td><td>yes</td><td>string</td><td>Name of the item (100 character limit)</td></tr><tr><td>description</td><td>yes</td><td>string</td><td>Description of the item (200 character limit)</td></tr><tr><td>callback</td><td>no</td><td>string</td><td>URL to POST the transaction response to after the user authorizes the purchase. If not provided, will default to the Payment Callback URL set for the consumer application. If a URL could not be found in the application settings and this parameter is not set, a postback error will be induced. Only applies if <code>checkoutWithApi</code> is false (Pay Later flow).</td></tr><tr><td>redirect</td><td>no</td><td>string</td><td>URL to return the user to after they authorize or cancel a purchase. If not provided, the URL will default to the Payment Redirect URL set in the application&rsquo;s settings. If no URL could be found, an error will be induced.</td></tr><tr><td>allowFundingSources</td><td>no</td><td>string</td><td>Defaults to <code>false</code>, set to <code>true</code> to enable guest checkout and bank-funded payments. This would allow users without a Dwolla account to pass through the checkout flow.</td></tr><tr><td>checkoutWithApi</td><td>no</td><td>string</td><td>Defaults to <code>false</code> (and the Pay Now flow), set to <code>true</code> to use the Pay Later flow.</td></tr><tr><td>orderId</td><td>no</td><td>string</td><td>Optional string to identify the transaction (255 character limit).</td></tr><tr><td>test</td><td>no</td><td>string</td><td>Defaults to <code>false</code>, set to <code>true</code> to flag the PO for testing. Does not affect account balances nor are any e-mails sent. The transaction ID returned from a PO with <code>test</code> flagged will always be <code>1</code>.</td></tr><tr><td>tax</td><td>no</td><td>string</td><td>Tax applied to the order. Must be $0 or greater.</td></tr><tr><td>shipping</td><td>no</td><td>string</td><td>Shipping total for the order. Must be $0.00 or more.</td></tr><tr><td>facilitatorAmount</td><td>no</td><td>string</td><td>Amount of the facilitator fee (will override the amount in the application&rsquo;s settings). If set to <code>0</code>, the fee will be disabled. Must not exceed 25% of the transaction total.</td></tr><tr><td>notes</td><td>no</td><td>string</td><td>Note to attach to transaction (250 character limit).</td></tr></tbody></table><h4 id=hmac-sha1-hashing-required>HMAC-SHA1 Hashing - Required</h4><p>The hexadecimal hash is generated from the ampersand delimited text of the consumer key, <a href=http://en.wikipedia.org/wiki/Unix_time>Unix timestamp</a>, and orderId, even if an order ID is not provided. The text is then hashed using the consumer secret for the application as the hash key. The signature must be unique per request, so a new timestamp will need to be provided for each request. Below are examples on how to generate HMAC-SHA1 hashes in languages commonly used with web-stack development:</p><div class="code-snippet js-code-snippet language-raw"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-raw data-lang=raw>not applicable
</code></pre></div></div><div class="code-snippet js-code-snippet language-python"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-python data-lang=python><span class=k>def</span> <span class=nf>sign_request</span><span class=p>():</span>
  <span class=kn>from</span> <span class=nn>hashlib</span> <span class=kn>import</span> <span class=n>sha1</span>
  <span class=kn>import</span> <span class=nn>hmac</span>
  <span class=kn>import</span> <span class=nn>binascii</span>
  <span class=kn>import</span> <span class=nn>time</span>

  <span class=n>key</span>       <span class=o>=</span> <span class=s>'YOUR_APPLICATION_KEY'</span>
  <span class=n>secret</span>    <span class=o>=</span> <span class=s>'YOUR_APPLICATION_SECRET'</span>
  <span class=n>timestamp</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>())</span>
  <span class=n>order_id</span>  <span class=o>=</span> <span class=mi>1</span>
  <span class=n>text</span>      <span class=o>=</span> <span class=n>key</span> <span class=o>+</span> <span class=s>'&amp;'</span> <span class=o>+</span> <span class=n>timestamp</span> <span class=o>+</span> <span class=s>'&amp;'</span> <span class=o>+</span> <span class=n>order_id</span>

  <span class=nb>hash</span> <span class=o>=</span> <span class=n>hmac</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>secret</span><span class=p>,</span> <span class=n>text</span><span class=p>,</span> <span class=n>sha1</span><span class=p>)</span>

  <span class=c># We format the string to exclude the last character which is a newline delimiter.</span>
  <span class=k>return</span> <span class=n>binascii</span><span class=o>.</span><span class=n>b2a_base64</span><span class=p>(</span><span class=n>hashed</span><span class=o>.</span><span class=n>digest</span><span class=p>())[:</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</code></pre></div></div><div class="code-snippet js-code-snippet language-javascript"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-javascript data-lang=javascript><span class=kd>var</span> <span class=nx>crypto</span>    <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>'crypto'</span><span class=p>)</span>
  <span class=p>,</span> <span class=nx>key</span>       <span class=o>=</span> <span class=s1>'abcdeg'</span>
  <span class=p>,</span> <span class=nx>secret</span>    <span class=o>=</span> <span class=s1>'YOUR_APPLICAITON_SECRET'</span>
  <span class=p>,</span> <span class=nx>order_id</span>  <span class=o>=</span> <span class=mi>1</span>
  <span class=p>,</span> <span class=nx>timestamp</span> <span class=o>=</span> <span class=p>(</span><span class=k>new</span> <span class=nb>Date</span><span class=p>).</span><span class=nx>getTime</span><span class=p>()</span>
  <span class=p>,</span> <span class=nx>text</span>      <span class=o>=</span> <span class=nx>key</span> <span class=o>+</span> <span class=s1>'&amp;'</span> <span class=o>+</span> <span class=nx>timestamp</span> <span class=o>+</span> <span class=s1>'&amp;'</span> <span class=o>+</span> <span class=nx>order_id</span>
  <span class=p>,</span> <span class=nx>hash</span><span class=p>;</span>

<span class=nx>hash</span> <span class=o>=</span> <span class=nx>crypto</span><span class=p>.</span><span class=nx>createHmac</span><span class=p>(</span><span class=s1>'sha1'</span><span class=p>,</span> <span class=nx>secret</span><span class=p>).</span><span class=nx>update</span><span class=p>(</span><span class=nx>text</span><span class=p>).</span><span class=nx>digest</span><span class=p>(</span><span class=s1>'hex'</span><span class=p>);</span>
</code></pre></div></div><div class="code-snippet js-code-snippet language-ruby"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-ruby data-lang=ruby><span class=nb>require</span> <span class=s1>'rubygems'</span>
<span class=nb>require</span> <span class=s1>'base64'</span>
<span class=nb>require</span> <span class=s1>'cgi'</span>
<span class=nb>require</span> <span class=s1>'hmac-sha1'</span>

<span class=n>key</span>       <span class=o>=</span> <span class=s1>'YOUR_APPLICATION_KEY'</span>
<span class=n>secret</span>    <span class=o>=</span> <span class=s1>'YOUR_APPLICATION_SECRET'</span>
<span class=n>timestamp</span> <span class=o>=</span> <span class=no>Time</span><span class=p>.</span><span class=nf>now</span><span class=p>.</span><span class=nf>to_i</span>
<span class=n>order_id</span>  <span class=o>=</span> <span class=mi>1</span>

<span class=n>signature</span> <span class=o>=</span> <span class=s2>"</span><span class=si>#{</span><span class=n>key</span><span class=si>}</span><span class=s2>&amp;</span><span class=si>#{</span><span class=n>timestamp</span><span class=si>}</span><span class=s2>&amp;</span><span class=si>#{</span><span class=n>order_id</span><span class=si>}</span><span class=s2>"</span>

<span class=n>hmac</span> <span class=o>=</span> <span class=no>HMAC</span><span class=o>::</span><span class=no>SHA1</span><span class=p>.</span><span class=nf>new</span><span class=p>(</span><span class=n>secret</span><span class=p>)</span>
<span class=n>hmac</span><span class=p>.</span><span class=nf>update</span><span class=p>(</span><span class=n>signature</span><span class=p>)</span>
<span class=nb>hash</span> <span class=o>=</span> <span class=no>CGI</span><span class=p>.</span><span class=nf>escape</span><span class=p>(</span><span class=no>Base64</span><span class=p>.</span><span class=nf>encode64</span><span class=p>(</span><span class=s2>"</span><span class=si>#{</span><span class=n>hmac</span><span class=p>.</span><span class=nf>digest</span><span class=si>}</span><span class=se>\n</span><span class=s2>"</span><span class=p>))</span>
</code></pre></div></div><div class="code-snippet js-code-snippet language-php"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-php data-lang=php><span class=cp>&lt;?php</span>
<span class=nv>$key</span>        <span class=o>=</span> <span class=s2>"YOUR_APPLICATION_KEY"</span><span class=p>;</span>
<span class=nv>$secret</span>     <span class=o>=</span> <span class=s2>"YOUR_APPLICATION_SECRET"</span><span class=p>;</span>
<span class=nv>$timestamp</span>  <span class=o>=</span> <span class=nb>time</span><span class=p>();</span> <span class=c1>// example: 1390408833
</span><span class=nv>$order_id</span>   <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>

<span class=nv>$signature</span>  <span class=o>=</span> <span class=nb>hash_hmac</span><span class=p>(</span><span class=s1>'sha1'</span><span class=p>,</span> <span class=s2>"</span><span class=si>{</span><span class=nv>$key</span><span class=si>}</span><span class=s2>&amp;</span><span class=si>{</span><span class=nv>$timestamp</span><span class=si>}</span><span class=s2>&amp;</span><span class=si>{</span><span class=nv>$order_id</span><span class=si>}</span><span class=s2>"</span><span class=p>,</span> <span class=nv>$secret</span><span class=p>);</span>
<span class=cp>?&gt;</span>
</code></pre></div></div><h4 id=example-form>Example form</h4><div class="code-snippet js-code-snippet language-html"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-html data-lang=html><span class=nt>&lt;form</span> <span class=na>accept-charset=</span><span class=s>"UTF-8"</span> <span class=na>action=</span><span class=s>"https://www.dwolla.com/payment/pay"</span> <span class=na>method=</span><span class=s>"post"</span><span class=nt>&gt;</span>

<span class=nt>&lt;input</span> <span class=na>id=</span><span class=s>"key"</span> <span class=na>name=</span><span class=s>"key"</span> <span class=na>type=</span><span class=s>"hidden"</span> <span class=na>value=</span><span class=s>"abcdefg"</span> <span class=nt>/&gt;</span>
<span class=nt>&lt;input</span> <span class=na>id=</span><span class=s>"signature"</span> <span class=na>name=</span><span class=s>"signature"</span> <span class=na>type=</span><span class=s>"hidden"</span> <span class=na>value=</span><span class=s>"abcd"</span> <span class=nt>/&gt;</span>
<span class=nt>&lt;input</span> <span class=na>id=</span><span class=s>"timestamp"</span> <span class=na>name=</span><span class=s>"timestamp"</span> <span class=na>type=</span><span class=s>"hidden"</span> <span class=na>value=</span><span class=s>"1323302400"</span> <span class=nt>/&gt;</span>
<span class=nt>&lt;input</span> <span class=na>id=</span><span class=s>"callback"</span> <span class=na>name=</span><span class=s>"callback"</span> <span class=na>type=</span><span class=s>"hidden"</span> <span class=na>value=</span><span class=s>"http://www.mywebsite.com/callback.aspx"</span> <span class=nt>/&gt;</span>
<span class=nt>&lt;input</span> <span class=na>id=</span><span class=s>"redirect"</span> <span class=na>name=</span><span class=s>"redirect"</span> <span class=na>type=</span><span class=s>"hidden"</span> <span class=na>value=</span><span class=s>"http://www.mywebsite.com/redirect.aspx"</span> <span class=nt>/&gt;</span>
<span class=nt>&lt;input</span> <span class=na>id=</span><span class=s>"test"</span> <span class=na>name=</span><span class=s>"test"</span> <span class=na>type=</span><span class=s>"hidden"</span> <span class=na>value=</span><span class=s>"false"</span> <span class=nt>/&gt;</span>
<span class=nt>&lt;input</span> <span class=na>id=</span><span class=s>"name"</span> <span class=na>name=</span><span class=s>"name"</span> <span class=na>type=</span><span class=s>"hidden"</span> <span class=na>value=</span><span class=s>"Purchase"</span> <span class=nt>/&gt;</span>
<span class=nt>&lt;input</span> <span class=na>id=</span><span class=s>"description"</span> <span class=na>name=</span><span class=s>"description"</span> <span class=na>type=</span><span class=s>"hidden"</span> <span class=na>value=</span><span class=s>"Description"</span> <span class=nt>/&gt;</span>
<span class=nt>&lt;input</span> <span class=na>id=</span><span class=s>"destinationid"</span> <span class=na>name=</span><span class=s>"destinationid"</span> <span class=na>type=</span><span class=s>"hidden"</span> <span class=na>value=</span><span class=s>"812-713-9234"</span> <span class=nt>/&gt;</span>
<span class=nt>&lt;input</span> <span class=na>id=</span><span class=s>"amount"</span> <span class=na>name=</span><span class=s>"amount"</span> <span class=na>type=</span><span class=s>"hidden"</span> <span class=na>value=</span><span class=s>"1.00"</span> <span class=nt>/&gt;</span>
<span class=nt>&lt;input</span> <span class=na>id=</span><span class=s>"shipping"</span> <span class=na>name=</span><span class=s>"shipping"</span> <span class=na>type=</span><span class=s>"hidden"</span> <span class=na>value=</span><span class=s>"0.00"</span> <span class=nt>/&gt;</span>
<span class=nt>&lt;input</span> <span class=na>id=</span><span class=s>"tax"</span> <span class=na>name=</span><span class=s>"tax"</span> <span class=na>type=</span><span class=s>"hidden"</span> <span class=na>value=</span><span class=s>"0.00"</span> <span class=nt>/&gt;</span>
<span class=nt>&lt;input</span> <span class=na>id=</span><span class=s>"orderid"</span> <span class=na>name=</span><span class=s>"orderid"</span> <span class=na>type=</span><span class=s>"hidden"</span> <span class=na>value=</span><span class=s>"188375"</span> <span class=nt>/&gt;</span>

<span class=nt>&lt;button</span> <span class=na>type=</span><span class=s>"submit"</span><span class=nt>&gt;</span>Submit Order<span class=nt>&lt;/button&gt;</span>
<span class=nt>&lt;/form&gt;</span>
</code></pre></div></div><p>Depending on the checkout flow utilized, the user will be redirected to the <code>redirect</code> URL with either completed transaction details or a confirmation page on the merchant&rsquo;s webpage wherein they will complete their transaction.</p><p>If any errors incur, they will be passed as parameters to the redirect URL:</p><h5 id=url-example-success-and-failure>URL example - success and failure</h5><div class="code-snippet js-code-snippet language-nohide"><button class="btn alternative">copy</button><div class="code-snippet__cnt highlight"><pre><code class=language-nohide data-lang=nohide>// Success
Format: https://www.myurl.com/redirect?signature={}&amp;orderId={}&amp;amount={}&amp;checkoutId={}&amp;status={}&amp;clearingDate={}&amp;transaction={}&amp;postback={}

Example: https://www.myurl.com/redirect?signature=c50e4b2a4c50ad795c3ee31370aec1a563565aa4&amp;orderId=&amp;amount=0.01&amp;checkoutId=f32b1e55-9612-4b6d-90f9-1c1519e588da&amp;status=Completed&amp;clearingDate=8/28/2012%203:17:18%20PM&amp;transaction=1312616&amp;postback=success

// Failure
Format: https://www.myurl.com/redirect?checkoutId={}&amp;error=failure&amp;error_description={}

Example: https://www.myurl.com/redirect?checkoutId=694e6bcb-349f-451d-bf5d-8aa16530c960&amp;error=failure&amp;error_description=There+are+insufficient+funds+for+this+transaction

Possible error_descriptions:
"Payment has already been generated for application, timestamp, and order ID."
"Invalid callback URL"
"Invalid application signature."
"Invalid timestamp."
"Invalid application credentials."
"There are insufficient funds for this transaction."
"User Cancelled"
"Invalid destination user."
</code></pre></div></div><h4 id=example-return>Example return</h4><div class="code-snippet js-code-snippet language-phpnohide"><button class="btn alternative">copy</button><div class="code-snippet__cnt highlight"><pre><code class=language-phpnohide data-lang=phpnohide><span class=cp>&lt;?php</span>
<span class=c1>// First, check for any errors
</span><span class=k>if</span> <span class=p>(</span><span class=nb>array_key_exists</span><span class=p>(</span><span class=s2>"error"</span><span class=p>,</span> <span class=nv>$_GET</span><span class=p>))</span> <span class=p>{</span>
    <span class=c1>// find out what happened:
</span>    <span class=nv>$error_description</span> <span class=o>=</span> <span class=nv>$_GET</span><span class=p>[</span><span class=s1>'error_description'</span><span class=p>];</span> <span class=c1>// "User Cancelled"
</span>    <span class=k>exit</span><span class=p>(</span><span class=nv>$error_description</span><span class=p>);</span>
<span class=p>}</span>

<span class=c1>// Create a function that verifies offsite-gateway signature hash against server-provided hash.
</span><span class=k>function</span> <span class=nf>verifyGatewaySignature</span><span class=p>(</span><span class=nv>$proposedSignature</span><span class=p>,</span> <span class=nv>$checkoutId</span><span class=p>,</span> <span class=nv>$amount</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>global</span> <span class=nv>$secret</span><span class=p>;</span>
    <span class=nv>$key</span>        <span class=o>=</span> <span class=s2>"Your key here"</span><span class=p>;</span>
    <span class=nv>$secret</span>     <span class=o>=</span> <span class=s2>"Your secret here"</span><span class=p>;</span>
    <span class=nv>$amount</span> <span class=o>=</span> <span class=nb>number_format</span><span class=p>(</span><span class=nv>$amount</span><span class=p>,</span> <span class=mi>2</span><span class=p>);</span>
    <span class=nv>$signature</span> <span class=o>=</span> <span class=nb>hash_hmac</span><span class=p>(</span><span class=s2>"sha1"</span><span class=p>,</span> <span class=s2>"</span><span class=si>{</span><span class=nv>$checkoutId</span><span class=si>}</span><span class=s2>&amp;</span><span class=si>{</span><span class=nv>$amount</span><span class=si>}</span><span class=s2>"</span><span class=p>,</span> <span class=nv>$secret</span><span class=p>);</span>
    <span class=k>return</span> <span class=nv>$signature</span> <span class=o>==</span> <span class=nv>$proposedSignature</span><span class=p>;</span>
<span class=p>}</span>

<span class=c1>// Second, extract the checkoutId, amount, and signature of the checkout:
</span><span class=nv>$checkoutId</span> <span class=o>=</span> <span class=nv>$_GET</span><span class=p>[</span><span class=s1>'checkoutId'</span><span class=p>];</span>
<span class=nv>$amount</span> <span class=o>=</span> <span class=nv>$_GET</span><span class=p>[</span><span class=s1>'amount'</span><span class=p>];</span>
<span class=nv>$signature</span> <span class=o>=</span> <span class=nv>$_GET</span><span class=p>[</span><span class=s1>'signature'</span><span class=p>];</span>

<span class=c1>// Third, validate the signature before you do anything with the data.
</span><span class=nv>$signatureValid</span> <span class=o>=</span> <span class=nx>verifyGatewaySignature</span><span class=p>(</span><span class=nv>$signature</span><span class=p>,</span> <span class=nv>$checkoutId</span><span class=p>,</span> <span class=nv>$amount</span><span class=p>);</span>
<span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nv>$signatureValid</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>exit</span><span class=p>(</span><span class=s2>"Signature is not valid!"</span><span class=p>);</span>
<span class=p>}</span>

<span class=nv>$status</span> <span class=o>=</span> <span class=nv>$_GET</span><span class=p>[</span><span class=s1>'status'</span><span class=p>];</span>
<span class=k>if</span> <span class=p>(</span><span class=nv>$status</span> <span class=o>==</span> <span class=s2>"Completed"</span><span class=p>)</span> <span class=p>{</span>
    <span class=c1>// do something useful with the checkout results:
</span>    <span class=k>echo</span> <span class=nv>$status</span><span class=p>;</span>
<span class=p>}</span>

<span class=cp>?&gt;</span>
</code></pre></div></div><nav class=pager-nav><a href="./">Back: Overview</a> <a href="" style=display:none></a></nav><hr><footer><div class=page-wrap><nav><h6>Product</h6><a href=https://www.dwolla.com/platform>Platform</a> <a href=https://www.dwolla.com/bank-transfers>Bank Transfers</a> <a href=https://www.dwolla.com/same-day-ach>Expedited Payments</a> <a href=https://www.dwolla.com/dwollajs-bank-verification>Instant Bank Account Verification</a> <a href=https://www.dwolla.com/mass-payments-api>Mass Payments</a> <a href="https://www.dwolla.com/integrations?b=footer">Integrations</a> <a href=https://www.dwolla.com/white-label>White Label</a> <a href=https://www.dwolla.com/ach-transfer-dashboard>Dashboard</a></nav><nav><h6>Legal</h6><a href="https://www.dwolla.com/legal/tos/">Terms of Service</a> <a href="https://www.dwolla.com/legal/privacy/">Privacy Policy</a> <a href=https://www.dwolla.com/security>Security</a> <a href="https://www.dwolla.com/legal/about-our-financial-institution-partner/">Financial Institution Partners</a></nav><nav><h6>Learn More</h6><a href="https://www.dwolla.com/case-studies?b=accesscta1">Case Studies</a> <a href="https://www.dwolla.com/updates/">Blog</a> <a href=https://www.dwolla.com/industry-initiatives>Industry Initiatives</a> <a href="https://developers.dwolla.com/?b=footer">Developer Resources</a></nav><nav><h6>Company</h6><a href="https://www.dwolla.com/about?b=footer">About</a> <a href=https://www.dwolla.com/careers>Careers</a> <a href=https://www.dwolla.com/press>Press</a> <a href="https://www.dwolla.com/contact?b=footer">Contact Us</a></nav></div></footer><section class=disclaimer><div class=page-wrap><h5>Financial institutions play an important role in the Dwolla network.</h5><p>Dwolla, Inc. is an agent of Veridian Credit Union and Compass Bank and all funds associated with your account in the Dwolla network are held in pooled accounts at Veridian Credit Union and Compass Bank. These funds are not eligible for individual insurance, including FDIC insurance and may not be eligible for share insurance by the National Credit Union Share Insurance Fund. Dwolla, Inc. is the operator of a software platform that communicates user instructions for funds transfers to Veridian Credit Union and Compass Bank.</p></div></section><section class=copyright><div class=page-wrap><div><span>&copy; 2018 Dwolla, Inc.</span> <a href="https://www.dwolla.com/legal/about-our-financial-institution-partner/">Dwolla, Inc. is an agent of its Financial Institution Partner(s)</a></div></div></section></section></div></div></div><script src=//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js></script><script>window.jQuery || document.write('<script src="/_bower_components/jquery/jquery.min.js"><\/script>')</script><script src=/js/script.c827.js></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
  function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
  e=o.createElement(i);r=o.getElementsByTagName(i)[0];
  e.src='//www.google-analytics.com/analytics.js';
  r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
  ga('create','UA-30404064-1');ga('send','pageview');</script><script type=text/javascript>(function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',intercomSettings);}else{var d=document;var i=function(){i.c(arguments)};i.q=[];i.c=function(args){i.q.push(args)};w.Intercom=i;function l(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/dfdjs7vb';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);}if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})()

  window.Intercom('boot', {
    app_id: 'dfdjs7vb'
  });</script><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WRT5LD6" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript></body></html>